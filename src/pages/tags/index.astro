---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getUniqueTags } from '../../utils/helpers';

const posts = await getCollection('blog', ({ data }) => !data.draft);
const tags = getUniqueTags(posts);

const tagCounts = tags.map((tag) => ({
  name: tag,
  count: posts.filter((p) => p.data.tags.includes(tag)).length,
}));
---

<BaseLayout title="Tags" description="Browse posts by tag">
  <h1 class="text-2xl font-bold mb-6 flex items-center gap-2">
    <span class="text-accent">$</span> ls tags/
  </h1>
  
  <div class="flex flex-wrap gap-3">
    {tagCounts.map((tag) => (
      <a 
        href={`/tags/${tag.name}/`}
        class="post-card"
      >
        <span class="text-lg font-semibold">#{tag.name}</span>
        <span class="text-fg/50 text-sm ml-2">({tag.count})</span>
      </a>
    ))}
  </div>
</BaseLayout>
