---
import { formatDate, readingTime, getPostSlug } from '../lib/utils';

interface Props {
  title: string;
  date: Date;
  categories: string[];
  tags: string[];
  slug: string;
  body?: string;
}

const { title, date, categories, tags, slug, body = '' } = Astro.props;
const readTime = readingTime(body);
const catPath = categories.map(c => c.toLowerCase()).join('/');
---

<a
  href={`/${slug}/`}
  class="post-card group block"
>
  <!-- Meta row: date | category | reading time -->
  <div class="flex items-center gap-3 font-mono text-xs text-fg-dim mb-2">
    <time datetime={date.toISOString()} class="text-date">
      {formatDate(date)}
    </time>

    {catPath && (
      <>
        <span class="text-border-hover">|</span>
        <span class="text-category">{catPath}</span>
      </>
    )}

    <span class="ml-auto text-fg-dim">{readTime} min read</span>
  </div>

  <!-- Title -->
  <h3 class="font-mono text-base font-semibold text-fg group-hover:text-accent transition-colors mb-2">
    {title}
  </h3>

  <!-- Tags -->
  {tags.length > 0 && (
    <div class="flex flex-wrap gap-2">
      {tags.slice(0, 5).map(tag => (
        <span class="text-xs text-tag">#{tag.toLowerCase()}</span>
      ))}
      {tags.length > 5 && (
        <span class="text-xs text-fg-dim">+{tags.length - 5}</span>
      )}
    </div>
  )}
</a>
