---
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import { formatDate, getReadingTime } from '../utils/helpers';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { title, description, date, categories, tags } = post.data;
const readingTime = getReadingTime(post.body || '');
---

<BaseLayout title={title} description={description}>
  <article class="prose">
    <header class="mb-8">
      <h1 class="text-3xl font-bold mb-4">{title}</h1>
      
      <div class="flex flex-wrap items-center gap-4 text-sm text-fg/60">
        <time datetime={date.toISOString()}>
          {formatDate(date)}
        </time>
        
        <span class="text-accent/60">{readingTime}</span>
        
        {categories.length > 0 && (
          <div class="flex gap-2">
            {categories.map((category) => (
              <a 
                href={`/categories/${category}/`}
                class="text-accent hover:underline"
              >
                {category}
              </a>
            ))}
          </div>
        )}
      </div>
      
      {tags.length > 0 && (
        <div class="flex flex-wrap gap-2 mt-4">
          {tags.map((tag) => (
            <a 
              href={`/tags/${tag}/`}
              class="px-2 py-1 text-xs bg-bg-light/10 rounded hover:bg-accent/20 transition-colors"
            >
              #{tag}
            </a>
          ))}
        </div>
      )}
    </header>
    
    <slot />
    
    <footer class="mt-12 pt-8 border-t border-border">
      <div class="giscus-container">
        <script 
          src="https://giscus.app/client.js"
          data-repo="sbulav/sbulav.github.io"
          data-repo-id="MDEwOlJlcG9zaXRvcnkyNTU4MTM5MDE="
          data-category="General"
          data-category-id="DIC_kwDODz9pDc4CzD1l"
          data-mapping="pathname"
          data-strict="0"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="top"
          data-theme="dark"
          data-lang="en"
          crossorigin="anonymous"
          async
        ></script>
      </div>
    </footer>
  </article>
</BaseLayout>
